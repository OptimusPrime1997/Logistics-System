/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ui.warehousemanui;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.FocusAdapter;
import java.awt.event.FocusEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;
import java.rmi.RemoteException;

import javax.swing.GroupLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

import main.MainFrame;
import ui.Img;
import ui.util.ButtonType;
import ui.util.MyButton;
import ui.util.MyLabel;
import util.enumData.ResultMessage;
import bl.controllerfactorybl.ControllerFactoryImpl;
import bl.loginbl.Loginbl;
import blservice.stockblservice.StockNumBLService;


/**
 *
 * @author G
 */
public class InitialStockNumPanel extends JFrame{

	public static void main(String[] args) {
		new InitialStockNumPanel();
	}
    /**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	/**
     * Creates new form InitialStockNumPanel
     */
    public InitialStockNumPanel() {
    	panel = new JPanel() {
    		/* (non-Javadoc)
    		 * @see javax.swing.JComponent#paintComponent(java.awt.Graphics)
    		 */
    		@Override
    		protected void paintComponent(Graphics g) {
    			g.drawImage(Img.getBackground_main(), 0, 0, null);
    		}
    	};
    	panel.setLayout(null);
        initComponents();
        this.setContentPane(panel);
        
        
        addMouseListener(new MouseAdapter() {
			public void mousePressed(MouseEvent e) {
				mousePressedX = e.getX();
				mousePressedY = e.getY();
			}
		});
		addMouseMotionListener(new MouseMotionAdapter() {
			public void mouseDragged(MouseEvent e) {
				int x = (int) getLocation().getX();
				int y = (int) getLocation().getY();
				setLocation(x + e.getX() - mousePressedX, y + e.getY()
						- mousePressedY);
			}
		});
		
		this.setUndecorated(true);
		this.setBackground(new Color(0,0,0,0));        
        this.setVisible(true);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
    	
    	
    	/**
    	 * 设置窗体大小
    	 */
    	this.setSize(800, 500);
    	/**
    	 * 设置窗体大小为不可变
    	 */
    	this.setResizable(false);
    	/**
    	 * 设置窗体在中部出现
    	 */
    	Toolkit tk = Toolkit.getDefaultToolkit();
    	Dimension screensize = tk.getScreenSize();
    	int screenh = screensize.height;
    	int screenw = screensize.width;
    	this.setLocation(screenw/2-this.getWidth()/2, screenh/2-this.getHeight()/2);
    	/**
    	 * 关闭窗口
    	 */
    	setDefaultCloseOperation(EXIT_ON_CLOSE);

        userLabel = new MyLabel("当前账户："+Loginbl.getCurrentOptorName(), 500, 30, 300, 20);
        exit = new MyButton(750, 10, ButtonType.EXIT);
        jLabel1 = new MyLabel("本仓库初始的库存数量：", 180, 160, 180, 20);
        jTextField1 = new javax.swing.JTextField();
        jTextField1.setText("初始库存数量");
        jTextField1.setBounds(330, 200, 140, 30);
        confirm = new MyButton(450, 300, ButtonType.OK);
        //TODO 
        back = new MyButton(320, 300, ButtonType.CANCEL);
        resultMessage = new MyLabel("反馈", 30, 470, 800, 20);
        
       
        panel.add(userLabel);
        panel.add(exit);
        panel.add(jLabel1);
        panel.add(jTextField1);
        panel.add(confirm);
        panel.add(back);
        panel.add(resultMessage);
        
        exit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitActionPerformed(evt);
            }
        });
      

      
        
        jTextField1.addFocusListener(new FocusAdapter() {
        	
        	public void focusGained(FocusEvent e) {
        		jTextField1.setText("");
        	}
        
        	
		});
        

        confirm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

 
        back.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

    }
    StockNumBLService sc = ControllerFactoryImpl.getInstance().getStockNumController();
    /**
	 * @param evt
	 * 返回
	 */
	private void jButton2ActionPerformed(ActionEvent evt) {
		WarehousePanel w = new WarehousePanel();
		w.setVisible(true);
		this.dispose();
		
	}

	/**
	 * @param evt
	 * 
	 * 确定
	 */
	private void jButton1ActionPerformed(ActionEvent evt) {
		
		String s = jTextField1.getText().trim();
		try {
			ResultMessage r = sc.initial(s);
			showFeedback(r, "库存初始化");
		} catch (RemoteException e) {
			showFeedback(null, "远程连接错误");
		}

		
		
		
		
	}

	/**
	 * 
	 * @param evt
	 * 退出
	 */
	private void exitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
		MainFrame mf = new MainFrame();
    	mf.setVisible(true);
    	this.dispose();
    }//GEN-LAST:event_jButton3ActionPerformed


	private void showFeedback(ResultMessage msg, String operation) {
	    	
	   	if (msg.equals(ResultMessage.SUCCESS)) {
	   		this.resultMessage.setForeground(Color.GREEN);
		} else {
			this.resultMessage.setForeground(Color.RED);
		}
	    	
    	this.resultMessage.setText(operation + ResultMessage.toFriendlyString(msg));
	}
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private MyButton confirm;
    private MyButton back;
    private MyButton exit;
    private MyLabel jLabel1;
    private MyLabel userLabel;
    private javax.swing.JTextField jTextField1;
    private MyLabel resultMessage;
    private JPanel panel;
    private int mousePressedX;
   	private int mousePressedY;
    // End of variables declaration//GEN-END:variables
}
